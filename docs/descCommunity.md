#### Описание проекта.

Проект предназначен для размещения пользователями сообщений в децентрализованной системе.
Создание и удаление данных связано с изменением баланса токенов `PAGE` и `NFT` токенов `PAGE` на кошельках пользователей
Пользователи могут объединяться в сообщества. Сообщество - группа пользователей, объединенная какими-либо общими интересами.

Сначала создаются Сообщества. Каждое сообщество может создавать свои посты и комментарии к постам.
Создание поста автоматически влечет создание `NFT` токена. У каждого поста и комментария есть адрес кошелька 
пользователя - создателя и адрес кошелька пользователя - владельца. `NFT` токены (посты) можно передавать 
от одного пользователя к другому. Но передача `NFT` кому-либо просто так не возможна. 
Она возможна при условии, что пользователь - получатель `NFT` токена перед приемом токена дал approve() на эту операцию.

Вместе с комментариями к постам идут upvotes, downvotes.  upvotes, downvotes не существуют без комментариев.
Для одного комментария может быть только что-то одно: либо upvotes, либо downvotes.

Члены Сообществ выбирают и сами назначают себе модераторов.
Только модератор может удалить комментарии, созданные в Сообществе.
Процедура назначения модератора или его удаления осуществляется через процедуру голосования членов этого 
сообщества с помощью контракта `PageVoteForFeeAndModerator`.
При голосовании учитывается количество токенов `PAGE`, находящихся на кошельке этого пользователя и на балансе его 
аккаунта в контракте `PageBank`.
Эти значения суммируются и дают вес голосу. Таким образом токены `PAGE` это еще и токены управления.

По умолчанию в Сообществе пост может удалить только владелец этого поста.  
Комментарий может удалить модератор сообщества.

У постов и комментариев есть свойство видимости. По-умолчанию оно включено.
Но модератор сообщества может управлять этим свойством.

Сообщества могут быть активными и неактивными. Комментарии и посты у неактивных сообществ нельзя читать, удалять и создавать новые.
Активность сообщества можно изменить только путем голосования членов этого сообщества.

Приватный доступ в Сообщество можно включить путем голосования членов Сообщества через контракт `PageVoteForEarn`.
За приватный доступ члены Сообщества платят в токенах `PAGE` через контракт `PageBank`.
Заработанные Сообществом токены за приватный доступ путем голосования можно выводить на какой-либо кошелек пользователя.

Создание поста влечет к минту нового `NFT` токена и минту токенов `PAGE`. 
Количество токенов `PAGE` эквивалентно по стоимости количеству эфира затраченного на газ для этой операции.
Текущая стоимость токена берется с пула `ETH-PAGE`, созданного на Uniswap v3.
Создание комментария также вызывает минт токенов `PAGE` для компансации затрат на газ. Но `NFT` в этом случае не минтится.   
Для удаление поста или комментария надо затратить некоторое количество токенов `PAGE`.
При этих операциях распределение токенов `PAGE` касается 3-х кошельков: `Treasury Wallet`, `owner` и `creator`.
На эти кошельки токены распределяются не равномерно, а в процентном соотношении.
Величину этих процентов могут менять члены сообществ путем процедуры голосования через контракт `PageVoteForFeeAndModerator`.
При создании нового сообщества автоматически присваиваются значения по умолчанию. 

При деплое контрактов производится первоначальная эмиссия 50,000,000 токенов `PAGE` на `Treasury Wallet`.

## Основное workflow

#### Создание NFT токена (поста).
Значения по умолчанию
10% => to Treasury Wallet.
45% => to owner.
45% => to creator.

#### Создание комментария к посту.
Значения по умолчанию
10% => to Treasury Wallet.
45% => to owner
45% => to creator

#### Сжигание NFT-токена.
Значения по умолчанию
10% => to Treasury Wall
90% => from creator (идет списание)

#### Удаление комментария.
Значения по умолчанию
10% => to Treasury Wall
90% => from creator (идет списание)



#### По контракту BANK.
В контракте Bank есть переменная для хранения балансов пользователей в токенах `PAGE`.
Все заработанные токены `PAGE` фиксируются в этой переменной.
При удалении поста или коммента токены `PAGE` списываются с баланса этой переменной.
Если средств не хватает для удаления, то пользователь пополняет эту переменную токенами `PAGE`.


Существует фонд Treasure. В него производятся отчисления в размере 10% с каждого поста или комментария.
Величина % отчисления для фонда Treasure может корректироваться владельцем контракта BANK.


#### Основные контракты.

* `PageToken` - ERC-20 имплементация для токена `PAGE`. 
    Создавать и сжигать токены может только контракт `PageBank`.
    В этом контракте реализована логика которая позволяет это делать при создании или удалении постов и комментариев к ним.
* `PageNFT` - ERC-721 имплементация для токена `NFT.PAGE`. 
    Создание и сжигание токенов идет только от контракта `PageCommunity`.
* `PageUserRateToken` - ERC-1155 имплементация для токена `NFT.PAGE`.
    Минтинг новых токенов производится на основе заслуг пользователей за создание постов и комментариев 
    и за участие в "Безопасных сделках".    
  
* `PageCommunity` - контракт для управления сообществами.
    С помощью этого контракта можно создавать Сообщества, вступать и выходить из них, создавать и удалять посты и сообщения. 
* `PageBank` - контракт для расчета и выдачи компенсаций за газ в токенах `PAGE`.
    Стоимость токена `PAGE` берется из пула `ETH-PAGE`.  
* `PageCalcUserRate` - контракт в котором расположена логика по начислению токенов рэйтинга пользователей.
    Токены минтятся за новые 10, 100, 1000 постов или сообщений к ним, 
    за получение 100, 1000 upvotes, downvotes для владельцев постов.
    Также минтятся токены для каждого из участников "Безопасной сделки".
* `PageSafeDeal` - контракт для проведения "Безопасных сделок".
    Более подробное описание работы есть в отдельном файле.
    
* `PageVoteForFeeAndModerator` - голосование за модератора сообщества и за изменение процентов 
    по умолчанию при работе с постами и комментариями. 
    Также можно изменить тип владельца для новых постов с пользователя на Сообщество.
* `PageVoteForEarn` - голосование за перевод доступа к Сообществу в приватный режим. 
    За доступ к приватному режиму надо платить в токенах `PAGE` через контракт `PageBank`.
    Все заработанные токены идут на баланс Сообщества. Путем голосования эти токены можно выводить на кошелек 
    какого-либо пользователя. Также путем голосования можно переводить на кошелек пользователя НФТ-токены посты 
    для Сообществ, в которых новые посты принадлежат Сообществу.
* `PageVoteForSuperModerator` - голосование за выбор Супер Модератора.
    Участвовать в этом голосовании могут только модераторы из других Сообществ.
    Сейчас должно быть участие как минимум 2-х разных Сообществ для голосования. Но это значение можно менять.
    
    

#### Полезные ссылки

https://info-180.gitbook.io/white-paper-v0.2/
https://crypto.page/white_paper.html


#### Порядок деплоя
1. deploy PageUserRateToken (токен ERC-1155)
    initialize(string site_url)
    
2. deploy PageCalcUserRate (калькулятор рэйтинга пользователей)
    initialize(address _admin, address _userRateToken)
    
3. deploy PageBank (банк для пользователей)
    initialize(address _treasury, address _admin, address _userRateToken)
    setOracle
    pageCalcUserRate.grantRole для этого банка
    
4. deploy PageToken (токен ERC-20)
    initialize(address _treasury, address _bank)
    pageBank.setToken для этого токена

5. deploy pageSafeDeal
    initialize(address _admin, address _calcUserRate, address _bank)
    setToken для PageToken
    
6. deploy PageNFT (токен ERC-721)
    initialize(address _bank, string _baseURL)
    
7. deploy PageCommunity (основной контракт для всех сообществ пользователей)
    initialize(address _nft, address _bank, address _admin)
    pageNFT.setCommunity установка адреса комьюнити для токена с шага 6
    pageBank.grantRole(MINTER_ROLE) - адрес этого контракта
    pageBank.grantRole(BURNER_ROLE) - адрес этого контракта
    
8. deploy PageVoteForFeeAndModerator
   initialize(address _admin, address _token, address _community, address _bank)
   pageBank.grantRole(UPDATER_FEE_ROLE) - адрес этого контракта
   pageCommunity.addVoterContract - адрес этого контракта

9. deploy PageVoteForEarn
   initialize(address _admin, address _token, address _community, address _bank)
   pageBank.grantRole(VOTE_FOR_EARN_ROLE) - адрес этого контракта
   pageCommunity.addVoterContract - адрес этого контракта

10. deploy PageVoteForSuperModerator
   initialize(address _admin, address _token, address _community, address _bank)
   pageCommunity.addVoterContract - адрес этого контракта
   
=======================================================================================================

Необходимо сделать:
1. Сделать изменение видимости для Сообщества через голосование
2. Сделать скрипты для деплоя и верификации всех контрактов
